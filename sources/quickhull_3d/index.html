<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Demo TER</title>
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<style>
		body
		{
			background-color: black;
			margin: 0;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			height: 100vh;
		}
		main
		{
			width: 400px;
		}
		input#timeline
		{
			width: calc(100% - 10px);
			margin: 5px;
		}
	</style>
</head>

<body>
	<main>
		<canvas width="400" height="400"></canvas>
		<input type="range" id="timeline">
	</main>
</body>

<script src="vertex_list.js"></script>
<script src="3d_trigo.js"></script>
<script type="text/javascript">
	"use strict";
	// ------------- Génération de points aléatoires -------------
	for (let i = 0; i < 100; i++)
	{
		GLOBAL_V_LIST.push(
			multiply3_1(
				normalize3(
					minus3_1(
						vec3(
							Math.random(),
							Math.random(),
							Math.random()
						),
						.5
					)
				),
				Math.cbrt(Math.random())//*0 + 1
			)
		);
	}
	//GLOBAL_V_LIST.forEach((x)=>{mmm += "vec3("+x.x+','+x.y+','+x.z+")"+',';})
	//GLOBAL_V_LIST.push(vec3(-0.8392659782409725,0.14725222746885877,0.464685390697866),vec3(0.7060212476251292,-0.17242957787783333,0.4424036367441103),vec3(0.435428892071376,0.6643100087194364,0.2643774925921108),vec3(-0.0966787442671195,0.31831496610166,0.26551334633518614),vec3(0.41042301122732816,0.8725059168460273,0.2467425729908683),vec3(-0.38601063204554725,-0.20135120343300805,0.3810952612373273),vec3(-0.3579245559296899,-0.2892435736223608,-0.7182459580618934),vec3(-0.20315306615033793,0.28679519737661224,0.9059578058596),vec3(-0.3777425713719798,0.09034876393680102,0.41175599040878363),vec3(-0.568778478564486,-0.6223962326601602,0.40597726014408486));
	//GLOBAL_V_LIST.push(vec3(0.3992969615964859,0.6304808796310565,0.28089774017624475),vec3(-0.5330624209442987,0.3659721397646772,0.7050124168365262),vec3(-0.5456131917574891,-0.22729125884186796,0.19363503262577691),vec3(-0.37736954550467194,0.34723806407797125,0.0601703819888274),vec3(-0.6495923861492903,0.15776077831742233,0.03036695633938663),vec3(-0.3881995981851216,0.462382945978888,-0.32014925081182233),vec3(-0.4591465431381379,0.13577803996204532,0.37571537026162066),vec3(-0.15432810018476428,-0.16366659156294677,-0.22014368176949642),vec3(-0.31604729504167345,0.5313378856958401,-0.434478161296828),vec3(0.14173548642497816,0.6775309685907717,0.05736334933189214));
	//GLOBAL_V_LIST.push(vec3(0.12098266637719396,0.2157359072303719,0.25625100075604373),vec3(0.2635058529519854,-0.2782698434994832,-0.8259826734673829),vec3(-0.2028709821709893,0.35869843521660855,-0.4731272081090814),vec3(0.3000181936236143,0.10129770193096112,-0.5600664460725264),vec3(-0.2787962883888055,0.2661747611583505,0.1829131283383289),vec3(0.23106930708472212,0.5773156906727371,-0.41982249393948595),vec3(0.6451249969240697,0.2690667923743643,-0.3977986181215239),vec3(0.37546858740929967,0.3683591034623612,0.3712038091665223),vec3(0.6093575513455132,-0.27661882331339455,0.6651322944343195),vec3(0.4051363386207992,0.4937607951703732,0.3510392627373402));
	/*GLOBAL_V_LIST.push(vec3(-0.565431468817723,-0.35294119093060966,-0.44815511479275527),vec3(-0.18401128079745335,-0.21899924488401312,-0.13617519951936752),vec3(-0.7880750820408365,-0.26836679080926856,0.4024396313465027),vec3(-0.19266302370290872,-0.38676898115014646,0.43735078335061683),vec3(-0.4338857236025688,0.12496563641523564,-0.5310723955333727),vec3(-0.622557219814646,-0.7097268066215212,-0.11704040940938538),vec3(0.4224620593645664,-0.6731091071824844,0.1580699023178204),vec3(0.5428291954057103,-0.4884221822620063,0.41424089765198635),vec3(0.6154446431236298,0.3199756502160722,0.34068495616142186),vec3(0.4554581731926557,-0.1663220517133968,-0.419373385417721),vec3(-0.6640090410452895,-0.28256390521375496,-0.5031934858139786),vec3(0.36446194837112106,0.5598399666656328,-0.19307260385140076),vec3(-0.524820805514906,0.5810594657051515,0.5770927303239067),vec3(0.4905858040959439,-0.13257703245578187,0.14148188880027798),vec3(-0.22822070479447698,0.21892302735085004,-0.9134432243363789),vec3(-0.28445683176290437,0.2734258531582163,0.15129186155743063),vec3(-0.9224453745901897,-0.19929740060374532,0.06110397169764874),vec3(-0.5211458726908179,0.4477608663680991,0.6077454480978125),vec3(-0.39862349581743584,0.6322693930914918,-0.5172209527096101),vec3(-0.11191263156957776,-0.5210247443552625,0.675199360234196),vec3(0.5434882781614053,0.5371921859669199,0.3040834394783518),vec3(-0.4886434671685418,0.2897303812396424,-0.0543675380214117),vec3(-0.6112352509933647,-0.24160488155905788,0.13993691251478327),vec3(0.9134763088728013,0.011112145145303435,-0.017006117724629122),vec3(0.10418130805520416,-0.930981384824154,0.05631730562901349),vec3(-0.33953765082598814,0.551526093731778,0.6358646696690387),vec3(0.4018435999908163,-0.5308441083713864,-0.7176257562222925),vec3(-0.6784244888330404,0.016463637640139913,0.5762142805528191),vec3(0.10417545278575119,-0.09459478936271923,-0.22834753530153107),vec3(-0.8858157989521507,0.06331873465191079,-0.16589373086906087),vec3(-0.366627025637178,-0.34204108825633134,0.4276502145403448),vec3(0.46964672593508017,0.5758459818921385,-0.20871394879181718),vec3(-0.5830755791287805,0.5170705439006933,-0.11639950209744028),vec3(0.6300950406074174,-0.5702753824363593,0.18328415081641616),vec3(-0.41930933128987014,0.3588213916867215,-0.7193913772804789),vec3(0.6424779806517834,-0.4254295637225256,-0.4172899368950592),vec3(0.7913380320497903,-0.3934324813055443,0.10601690201563824),vec3(-0.4627569047586562,0.17430191324188216,0.23113129459682694),vec3(-0.8342013740560436,-0.0016023733334557264,0.5451020760079355),vec3(0.7937524729418586,0.1035702663488645,0.18387588806636357),vec3(-0.016828887743350444,-0.46824700132863956,-0.5374268577218896),vec3(-0.4607777175261998,0.4759393117994041,0.2871138782555081),vec3(-0.1013562621108023,-0.36675905910139117,-0.5595225807063909),vec3(0.6513939386236087,-0.3294387276346489,0.07659092308151519),vec3(-0.15247889790265015,-0.36182916135809834,-0.4335232528751125),vec3(-0.24422211084855078,0.6670423604260227,0.5984093927108999),vec3(0.10970380454370522,-0.025336771760039484,-0.6744729616795421),vec3(-0.8283272300926091,-0.44350755429924393,-0.11045712128370395),vec3(-0.40413473020526613,-0.39225530387743773,0.6162475294181232),vec3(0.23740311939693923,-0.02585613969920857,-0.24646320027214266),vec3(-0.3070915571427539,-0.03612742350387888,0.334393456934954),vec3(-0.09028588620082503,-0.018761104632105976,0.8393561545594544),vec3(0.18329198649710732,0.4879572276947342,0.40273520899561627),vec3(0.6017931970541808,0.2581692663255718,0.08415565545605226),vec3(0.3470194651461692,0.3880130385230462,-0.24859394350540098),vec3(-0.1869931952892742,-0.37014477939016993,-0.17253086290539452),vec3(0.4466158616927006,0.4691516760224243,-0.6912908628116493),vec3(0.4657474622951182,-0.4829841063303837,0.5139843037983031),vec3(-0.4712570470906718,-0.702996939042599,-0.10102067789214737),vec3(-0.46762074841920637,-0.6043290484708749,-0.6030566183489915),vec3(-0.532350289395621,-0.19125308490019824,-0.2152071656401793),vec3(0.10438402215026242,0.7835862471088364,0.20423366548812952),vec3(-0.687519010274385,-0.31360004304901634,-0.05532854205442657),vec3(0.4496507656904444,0.29808387264027575,0.7411962224903375),vec3(-0.264867330649687,-0.3339355319189483,-0.5754843615496258),vec3(0.4174156405582478,-0.48423559984466824,0.7267828142293997),vec3(0.525115119173878,-0.0511869581278291,0.6750371455578559),vec3(0.2619635798754056,0.03293252630586624,0.7756309113433407),vec3(0.026842475079808383,-0.2370274798737927,-0.5851675179215596),vec3(0.5106766324376455,0.45323806231537256,-0.28281976197709346),vec3(-0.21452650135155935,-0.49168484086680575,-0.38523436504100816),vec3(-0.5800028315013487,0.5585103498705237,0.4238228117853778),vec3(0.5902643260221121,0.1580641878326913,-0.2153318250827255),vec3(-0.19193295236859484,-0.20828413229577628,0.22666311933583305),vec3(-0.1808422788932634,-0.5181065875502587,-0.8310279491251705),vec3(0.35282694082749416,-0.33980419653142496,0.509395851273133),vec3(-0.2719170244359352,0.6837146100377325,0.3348251286553137),vec3(0.253665239356982,-0.23924136390793008,0.1571002844629793),vec3(0.4077806848526714,-0.5159365156579496,-0.0061801880036827725),vec3(0.5741624678016798,0.7360592570584001,-0.18408502069118168),vec3(0.34683970084866034,0.1156390489322706,-0.3849510685988463),vec3(0.4723975066188866,0.5259041226299755,0.39366097891822943),vec3(-0.3170188701451402,-0.13008491095463662,0.6318691164923886),vec3(-0.9216578112454915,-0.0309144654601097,0.355477614904213),vec3(0.4001476365745759,0.5112738432791036,-0.5320097488768681),vec3(0.6653846094690564,-0.01452778128435315,-0.5929193774199629),vec3(0.20137725182206637,-0.7764252789546662,-0.21086275486658212),vec3(0.4085205695607393,0.5995985496170285,-0.5549081297665414),vec3(0.3907343270330911,0.5243287235114991,0.5796058716348951),vec3(-0.2625744632831387,-0.5873413594928991,0.07382154744070847),vec3(0.7565738445723815,0.31787081080323776,0.395777455922912),vec3(-0.04785982503292635,-0.8014470222331188,-0.5851793878109418),vec3(0.1926622019021662,0.3455338909182507,0.6522283726826074),vec3(0.7508286069728853,0.5351674385432179,0.25910966657351536),vec3(0.5351866586501702,0.6833538735356636,-0.3098418441841989),vec3(0.18304496614382904,-0.5895216776962949,-0.560393429231847),vec3(-0.5659437267462968,0.4302318681047125,-0.44608960888323546),vec3(-0.3005294629081379,-0.43091432628602866,0.02576652613258504),vec3(-0.5516191775587366,-0.08759208603755333,0.8158804839234644),vec3(-0.41360430292511013,-0.13034294518797337,0.413619516713622));*/
</script>
<script src="wgl.js"></script>
<script src="display.js"></script>
<script src="structures.js"></script>
<script src="3d_quickhull.js"></script>
<script type="text/javascript">
	"use strict";

	let GLOBAL_DISP = new display(
		document.getElementsByTagName("canvas")[0],
		document.getElementById("timeline")
	);
	GLOBAL_DISP.init_vertex_list(GLOBAL_V_LIST);

	// ------------- Exécution -------------
	let t = performance.now();
	let convex_hull = quick_hull_3d(GLOBAL_V_LIST);
	console.info("Convexhull computation in: " + (performance.now() - t) + "ms")

	// console.table(convex_hull);
	// convex_hull = remove_face(convex_hull, convex_hull[0]);
	// convex_hull = remove_face(convex_hull, convex_hull[3]);
	// convex_hull = remove_face(convex_hull, convex_hull[6]);
	// convex_hull = remove_face(convex_hull, convex_hull[9]);
	// console.table(convex_hull);

	let result = [];
	he_for_each_faces(
		convex_hull,
		he_i =>
			he_for_each_vertices(
				convex_hull,
				he_i,
				(x,y,z) => result.push(x,y,z)
			)
		)
	;

	GLOBAL_DISP.push_result_indices(result);
	GLOBAL_DISP.set_ready();
	GLOBAL_DISP.new_frame();
	GLOBAL_DISP.autoplay();

</script>

</html>